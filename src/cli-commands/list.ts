import * as bcvesFromCLI from "../bcves-from-cli";
import { Config } from "../persistent-types";

export default async function (
  config: Config,
  args: {
    selectors: string[];
    full: boolean;
    allow_incomplete: boolean;
    no_sources: boolean;
    non_fatal_validation_errors: boolean;
  }
) {
  (await bcvesFromCLI.getBCVEs(config, args, !args.no_sources))
    .map(bcve => (args.full ? JSON.stringify(bcve, null, 2) : bcve.CVE))
    .forEach(l => console.log(l));
}
